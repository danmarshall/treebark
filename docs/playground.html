---
layout: default
title: Interactive Playground
description: Try Treebark interactively with real-time examples and customizable templates
---

<h1>Interactive Playground</h1>

<p>Experiment with Treebark templates and data in real-time. Choose from built-in examples or create your own!</p>

<div class="control-group">
    <label for="example-select">Load Example:</label>
    <select id="example-select" onchange="loadExampleFromDropdown()">
    </select>
</div>

<div class="error-display" id="error-display"></div>

<div class="playground-container">
    <div class="editor-panel">
        <div class="editor-header">
            Template Editor
        </div>
        <textarea 
            id="template-editor" 
            class="editor-textarea"
            spellcheck="false"
            placeholder="Enter your Treebark template here..."></textarea>
    </div>
    
    <div class="editor-panel">
        <div class="editor-header">
            Data Editor
        </div>
        <textarea 
            id="data-editor" 
            class="editor-textarea"
            spellcheck="false"
            placeholder="Enter your data (JSON format)..."></textarea>
    </div>
    
    <div class="output-panel">
        <div class="output-header">
            <span>Generated HTML</span>
            <div class="output-controls">
                <label for="indent-type">Indent:</label>
                <select id="indent-type">
                    <option value="none">None</option>
                    <option value="spaces" selected>Spaces</option>
                    <option value="tabs">Tabs</option>
                </select>
                <label for="indent-size">Size:</label>
                <input type="number" id="indent-size" min="1" max="8" value="2">
            </div>
        </div>
        <div class="output-content" id="html-output">
            <!-- Generated HTML will appear here -->
        </div>
    </div>
</div>

<script src="{{ '/assets/treebark-browser.js' | relative_url }}"></script>
<script>
// Example templates and data
// Example templates and data - loaded from external JSON file
let examples = {};

// Load examples from external JSON file to avoid Jekyll processing {{placeholders}}
async function loadExamples() {
    try {
        const response = await fetch('{{ "/assets/js/playground-examples.json" | relative_url }}');
        examples = await response.json();
        console.log('Examples loaded successfully');
        populateExampleDropdown();
    } catch (error) {
        console.error('Failed to load examples:', error);
        // Fallback: provide a minimal example if loading fails
        examples = {
            'hello-world': {
                template: {
                    div: {
                        class: "greeting",
                        $children: [
                            { h1: "Hello World!" },
                            { p: "Welcome to Treebark - safe HTML tree structures." }
                        ]
                    }
                },
                data: {}
            }
        };
        populateExampleDropdown();
    }
}

// Populate dropdown from examples JSON
function populateExampleDropdown() {
    const select = document.getElementById('example-select');
    
    const exampleIds = Object.keys(examples);
    
    // Add options for each example
    exampleIds.forEach(exampleId => {
        const option = document.createElement('option');
        option.value = exampleId;
        option.textContent = examples[exampleId].label || exampleId;
        select.appendChild(option);
    });
    
    // Auto-select and load the first example
    if (exampleIds.length > 0) {
        select.value = exampleIds[0];
        loadExample(exampleIds[0]);
    }
}

// Get DOM elements
const templateEditor = document.getElementById('template-editor');
const dataEditor = document.getElementById('data-editor');
const htmlOutput = document.getElementById('html-output');
const errorDisplay = document.getElementById('error-display');
const indentType = document.getElementById('indent-type');
const indentSize = document.getElementById('indent-size');

// Update output when inputs change
function updateOutput() {
    try {
        errorDisplay.style.display = 'none';
        errorDisplay.innerHTML = '';
        
        const templateText = templateEditor.value.trim();
        const dataText = dataEditor.value.trim();
        
        if (!templateText) {
            htmlOutput.textContent = '';
            return;
        }
        
        // Parse template
        let template;
        try {
            template = JSON.parse(templateText);
        } catch (e) {
            throw new Error('Invalid JSON in template: ' + e.message);
        }
        
        // Parse data
        let data = {};
        if (dataText) {
            try {
                data = JSON.parse(dataText);
            } catch (e) {
                throw new Error('Invalid JSON in data: ' + e.message);
            }
        }
        
        // Get indent options
        let indent = false;
        if (indentType.value !== 'none') {
            const size = parseInt(indentSize.value) || 2;
            indent = indentType.value === 'tabs' ? '\t'.repeat(size) : ' '.repeat(size);
        }
        
        // Capture console logs during rendering
        const logs = [];
        const originalError = console.error;
        const originalWarn = console.warn;
        const originalLog = console.log;
        
        console.error = (msg) => { logs.push({ level: 'error', message: msg }); originalError(msg); };
        console.warn = (msg) => { logs.push({ level: 'warn', message: msg }); originalWarn(msg); };
        console.log = (msg) => { logs.push({ level: 'log', message: msg }); originalLog(msg); };
        
        try {
            // Render using treebark
            const input = { template, data };
            const options = { indent };
            
            const html = window.Treebark ? window.Treebark.renderToString(input, options) : 'Treebark not loaded';
            
            htmlOutput.textContent = html;
        } finally {
            // Restore original console methods
            console.error = originalError;
            console.warn = originalWarn;
            console.log = originalLog;
        }
        
        // Display captured logs
        if (logs.length > 0) {
            const logMessages = logs.map(log => {
                const icon = log.level === 'error' ? '❌' : log.level === 'warn' ? '⚠️' : 'ℹ️';
                return `<div class="log-${log.level}">${icon} ${escapeHtml(log.message)}</div>`;
            }).join('');
            errorDisplay.innerHTML = logMessages;
            errorDisplay.style.display = 'block';
        }
        
    } catch (error) {
        errorDisplay.innerHTML = '<div class="log-error">❌ Error: ' + escapeHtml(error.message) + '</div>';
        errorDisplay.style.display = 'block';
        htmlOutput.textContent = '';
    }
}

// Helper function to escape HTML
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// Load example
function loadExample(exampleId) {
    const example = examples[exampleId];
    if (example) {
        templateEditor.value = JSON.stringify(example.template, null, 2);
        dataEditor.value = JSON.stringify(example.data, null, 2);
        updateOutput();
    }
}

// Load example from dropdown
function loadExampleFromDropdown() {
    const select = document.getElementById('example-select');
    const exampleId = select.value;
    if (exampleId) {
        loadExample(exampleId);
    }
}

// Event listeners
templateEditor.addEventListener('input', updateOutput);
dataEditor.addEventListener('input', updateOutput);
indentType.addEventListener('change', updateOutput);
indentSize.addEventListener('input', updateOutput);

// Load examples when page loads
document.addEventListener('DOMContentLoaded', async function() {
    await loadExamples();
});
</script>