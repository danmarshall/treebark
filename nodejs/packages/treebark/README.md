# Treebark for Node.js/Browser

Safe HTML tree structures for Markdown and content-driven apps.

## Installation

```bash
npm install treebark
```

## Quick Start

```javascript
import { renderToString } from 'treebark';

// Simple example
const html = renderToString({
  template: {
    div: {
      class: "greeting",
      $children: ["Hello {{name}}!"]
    }
  },
  data: { name: "World" }
});

console.log(html);
// Output: <div class="greeting">Hello World!</div>
```

## Features

### Automatic Array Iteration

When you provide a single template with array data, Treebark automatically creates multiple instances:

```javascript
import { renderToString } from 'treebark';

const html = renderToString({
  template: {
    div: {
      class: "product-card",
      $children: [
        { h2: "{{name}}" },
        { p: "Only {{price}}!" }
      ]
    }
  },
  data: [
    { name: "Laptop", price: "$999" },
    { name: "Mouse", price: "$25" }
  ]
});

console.log(html);
// Output: 
// <div class="product-card"><h2>Laptop</h2><p>Only $999!</p></div>
// <div class="product-card"><h2>Mouse</h2><p>Only $25!</p></div>
```

### Shorthand Array Syntax

For nodes without attributes, you can use shorthand syntax:

```javascript
import { renderToString } from 'treebark';

const html = renderToString({
  template: {
    div: [
      { h2: "Welcome" },
      { p: "This is much cleaner!" },
      {
        ul: [
          { li: "Item 1" },
          { li: "Item 2" }
        ]
      }
    ]
  }
});

console.log(html);
// Output: <div><h2>Welcome</h2><p>This is much cleaner!</p><ul><li>Item 1</li><li>Item 2</li></ul></div>
```

### Array Binding with $bind

For complex array scenarios:

```javascript
import { renderToString } from 'treebark';

const html = renderToString({
  template: {
    ul: {
      $bind: "products",
      $children: [
        { li: "{{name}} — {{price}}" }
      ]
    }
  },
  data: {
    products: [
      { name: "Laptop", price: "$999" },
      { name: "Phone", price: "$499" }
    ]
  }
});

console.log(html);
// Output: <ul><li>Laptop — $999</li><li>Phone — $499</li></ul>
```

### Comments

HTML comments can be created using the `comment` tag:

```javascript
import { renderToString } from 'treebark';

const html = renderToString({
  template: { comment: "This is a comment" }
});

console.log(html);
// Output: <!--This is a comment-->
```

Comments support interpolation:

```javascript
const html = renderToString({
  template: { comment: "Generated by {{generator}}" },
  data: { generator: "Treebark" }
});

console.log(html);
// Output: <!--Generated by Treebark-->
```

## API

### `renderToString(input, options?)`

Renders a template to an HTML string.

**Parameters:**
- `input: TreebarkInput` - Object with `template` and optional `data`
- `options?: RenderOptions` - Optional rendering options

**TreebarkInput format:**
```typescript
interface TreebarkInput {
  template: TemplateElement | TemplateElement[];
  data?: Record<string, unknown>;
}
```

**RenderOptions:**
```typescript
interface RenderOptions {
  data?: Record<string, unknown>;      // Default data context
  indent?: string | number | boolean;  // HTML indentation
}
```

**Returns:** `string` - Generated HTML

### `renderToDOM(input, options?)`

Renders a template to DOM nodes (browser only).

**Parameters:**
- `input: TreebarkInput` - Object with `template` and optional `data`  
- `options?: RenderOptions` - Optional rendering options

**Returns:** `DocumentFragment` - DOM fragment containing rendered nodes

### Template Format

Templates use object keys as HTML tag names:

- **String content:** `{ "div": "Hello world" }`
- **Array content (shorthand):** `{ "div": [{ "h1": "Title" }, { "p": "Text" }] }`
- **Object with attributes:** `{ "div": { "class": "card", "$children": [...] } }`
- **Data binding:** `{ "ul": { "$bind": "items", "$children": [...] } }`

### Security

Treebark is safe by default with a strict whitelist of allowed tags and attributes:

**Allowed tags:** `div`, `span`, `p`, `header`, `footer`, `main`, `section`, `article`, `h1`-`h6`, `strong`, `em`, `blockquote`, `code`, `pre`, `ul`, `ol`, `li`, `table`, `thead`, `tbody`, `tr`, `th`, `td`, `a`, `img`, `comment`

**Allowed attributes:** Global (`id`, `class`, `style`, `title`, `role`, `aria-*`, `data-*`) and tag-specific attributes.

## Examples

For comprehensive examples, documentation, and advanced features, see the [main Treebark repository](https://github.com/danmarshall/treebark).

## License

MIT